# Dog Companion - Instru√ß√µes para Claude

## Vis√£o Geral do Projeto

Este √© um aplicativo Next.js 16 para gerenciar fichas de personagens de D&D. Possui dois tipos de personagens:
- **Detetive**: Com um companheiro canino (C√£o)
- **Soldado**: Com uma arma sentiente (Espada)

## Tecnologias

- **Next.js 16** com App Router e Turbopack
- **TypeScript** (strict mode)
- **Tailwind CSS v4**
- **React 19**
- **LocalStorage** para persist√™ncia de dados

## Estrutura de Pastas

```
app/
‚îú‚îÄ‚îÄ components/          # Componentes reutiliz√°veis
‚îú‚îÄ‚îÄ detetive/
‚îÇ   ‚îî‚îÄ‚îÄ cao/            # P√°gina do companheiro canino
‚îî‚îÄ‚îÄ soldado/
    ‚îî‚îÄ‚îÄ espada/         # P√°gina da espada sentiente

types/
‚îú‚îÄ‚îÄ companion.ts        # Tipos do c√£o (Detetive)
‚îî‚îÄ‚îÄ sword.ts            # Tipos da espada (Soldado)
```

## Componentes Reutiliz√°veis Padronizados

**IMPORTANTE**: Sempre utilize estes componentes quando aplic√°vel. N√ÉO recrie l√≥gica inline que j√° existe nesses componentes.

### 1. Layout e Cabe√ßalhos

#### `ItemHeader`
Para cabe√ßalhos de personagens/itens com n√≠vel, imagem, e edi√ß√£o de nome.
```tsx
<ItemHeader
  itemName="Nome"
  itemType="Tipo"
  itemLevel={level}
  itemSubtitle="Subt√≠tulo"
  itemAlignment="Alinhamento"
  itemDescription="Descri√ß√£o"
  themeColor="amber" | "red"
  maxLevel={10}
  icon={<svg>...</svg>}
  onNameChange={handleNameChange}
  allowNameEdit={true}
/>
```

#### `SectionHeader`
Para t√≠tulos de se√ß√£o com √≠cone.
```tsx
<SectionHeader
  icon="üß≠"
  title="T√≠tulo"
  themeColor="amber" | "red"
/>
```

#### `ContentBox`
Container com t√≠tulo opcional para agrupar conte√∫do relacionado.
```tsx
<ContentBox title="T√≠tulo" icon="üìú" themeColor="amber" | "red">
  {children}
</ContentBox>
```

### 2. Estat√≠sticas e Atributos

#### `StatCard`
Para exibir estat√≠sticas (PV, CA, Deslocamento, etc).
```tsx
<StatCard
  label="PV"
  value="10/20"
  color="red" | "blue" | "green" | "amber" | "purple"
  interactive={{
    onDecrease: () => {},
    onIncrease: () => {}
  }}
/>
```

#### `AttributeGrid`
Grade de 6 atributos de D&D (FOR, DES, CON, INT, SAB, CAR).
```tsx
<AttributeGrid
  attributes={companion.attributes}
  themeColor="amber" | "red"
/>
```

### 3. Habilidades

#### `BaseAbilityCard`
Para habilidades fixas/autom√°ticas de n√≠veis 1 e 2.
```tsx
<BaseAbilityCard
  level={1}
  name="Nome da Habilidade"
  description="Descri√ß√£o completa"
  icon="üêæ"
  isUnlocked={character.level >= 1}
  themeColor="amber" | "red"
/>
```

#### `AbilityCard`
Para exibir habilidades j√° selecionadas (na aba de Combate).
```tsx
<AbilityCard
  name="Nome"
  description="Descri√ß√£o"
  level={3}
  type="Passiva" // opcional
  borderColor="border-red-700/50"
  bgColor="bg-red-950/20"
/>
```

#### `AbilitySelectionCard`
Para cards clic√°veis de sele√ß√£o de habilidades.
```tsx
<AbilitySelectionCard
  title="Nome ‚Äì Habilidade"
  description="Descri√ß√£o"
  category="Passiva" // opcional
  isSelected={isSelected}
  canSelect={canSelect}
  onClick={() => selectAbility(ability)}
  colorClasses="border-red-700/50 bg-red-950/20"
/>
```

#### `LevelSectionHeader`
Para cabe√ßalhos de se√ß√µes de n√≠vel com status.
```tsx
<LevelSectionHeader
  level={3}
  title="Escolha de Caminho"
  isLocked={!canSelect}
  isPending={canSelect && !selectedAbility}
/>
```

#### `PathInfoCard`
Para cards informativos sobre caminhos/tipos de habilidades.
```tsx
<PathInfoCard
  icon="‚öîÔ∏è"
  title="Presa Firme"
  subtitle="ofensivo"
  description="Focado em causar dano..."
  borderColor="border-red-700/50"
  bgGradient="from-red-950/20"
/>
```

### 4. Avisos e Notifica√ß√µes

#### `WarningBanner`
Para avisos de habilidades pendentes ou outras notifica√ß√µes.
```tsx
<WarningBanner
  title="Habilidades Pendentes"
  message="Voc√™ tem habilidades n√£o selecionadas..."
  buttonText="Ir para Habilidades"
  onButtonClick={() => setActiveTab('abilities')}
/>
```

### 5. Navega√ß√£o

#### `TabNavigation`
Para abas de navega√ß√£o com scroll horizontal no mobile.
```tsx
<TabNavigation
  tabs={[
    { id: 'combat', label: 'Combate', icon: '‚öîÔ∏è' },
    { id: 'abilities', label: 'Habilidades', icon: 'üß≠', badge: 2 },
    { id: 'hp', label: 'Pontos de Vida', icon: '‚ù§Ô∏è' },
  ]}
  activeTab={activeTab}
  onTabChange={(tabId) => setActiveTab(tabId)}
  themeColor="amber" | "red"
/>
```

#### `EquipmentTabs`
Para abas de equipamentos/itens com scroll horizontal no mobile.
```tsx
<EquipmentTabs
  equipments={DETETIVE_EQUIPMENTS}
  selectedId={selectedEquipment}
  onSelect={handleEquipmentSelect}
/>
```

## Padr√µes de P√°gina

### Estrutura Padr√£o de P√°gina de Personagem

```tsx
'use client';

import { useState, useEffect } from 'react';
import { /* types */ } from '@/types/...';
import ItemHeader from '@/app/components/ItemHeader';
import StatCard from '@/app/components/StatCard';
import AttributeGrid from '@/app/components/AttributeGrid';
import WarningBanner from '@/app/components/WarningBanner';
import SectionHeader from '@/app/components/SectionHeader';
import ContentBox from '@/app/components/ContentBox';
import AbilityCard from '@/app/components/AbilityCard';
import BaseAbilityCard from '@/app/components/BaseAbilityCard';
import AbilitySelectionCard from '@/app/components/AbilitySelectionCard';
import LevelSectionHeader from '@/app/components/LevelSectionHeader';
import PathInfoCard from '@/app/components/PathInfoCard';
import TabNavigation from '@/app/components/TabNavigation';

export default function CharacterPage({ level, onLevelChange }) {
  const [activeTab, setActiveTab] = useState<'combat' | 'abilities'>('combat');
  const [isLoaded, setIsLoaded] = useState(false);
  const [character, setCharacter] = useState(/* initial state */);

  // LocalStorage: Load on mount
  useEffect(() => {
    const saved = localStorage.getItem('character-key');
    if (saved) {
      try {
        setCharacter(JSON.parse(saved));
      } catch (e) {
        console.error('Failed to load data:', e);
      }
    }
    setIsLoaded(true);
  }, []);

  // LocalStorage: Save on changes
  useEffect(() => {
    if (isLoaded) {
      localStorage.setItem('character-key', JSON.stringify(character));
    }
  }, [character, isLoaded]);

  // Sync level with prop
  useEffect(() => {
    if (isLoaded && level !== character.level) {
      handleLevelChange(level);
    }
  }, [level, isLoaded]);

  // Prevent hydration mismatch
  if (!isLoaded) {
    return (
      <div className="min-h-screen bg-neutral-950 text-neutral-100">
        <div className="mx-auto flex min-h-screen max-w-4xl items-center justify-center">
          <div className="text-amber-100">Carregando...</div>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-neutral-950 text-neutral-100">
      <div className="mx-auto max-w-4xl px-4 py-6 sm:py-8">
        {/* Header com ItemHeader */}
        <ItemHeader {...headerProps} />

        {/* Stats com StatCard */}
        <div className="mb-6 grid grid-cols-2 gap-3 sm:grid-cols-3">
          <StatCard {...statProps} />
        </div>

        {/* Attributes com AttributeGrid */}
        <AttributeGrid {...attributeProps} />

        {/* Warning com WarningBanner se necess√°rio */}
        {hasWarning && <WarningBanner {...warningProps} />}

        {/* Tabs com TabNavigation */}
        <TabNavigation
          tabs={tabs}
          activeTab={activeTab}
          onTabChange={setActiveTab}
          themeColor="amber"
        />

        {/* Tab Content */}
        {activeTab === 'combat' && (
          <div className="space-y-6">
            <ContentBox title="Habilidades Ativas" icon="üìú" themeColor="amber">
              <div className="space-y-3">
                {/* AbilityCard components */}
              </div>
            </ContentBox>
          </div>
        )}

        {activeTab === 'abilities' && (
          <div className="space-y-6">
            {/* PathInfoCard grid se aplic√°vel */}
            <ContentBox title="Caminhos de Evolu√ß√£o" icon="üõ§Ô∏è" themeColor="amber">
              <div className="grid gap-3 sm:grid-cols-3">
                <PathInfoCard {...pathProps} />
              </div>
            </ContentBox>

            {/* Base Abilities */}
            <div className="space-y-3">
              <SectionHeader icon="üß≠" title="Habilidades de Classe" themeColor="amber" />
              <BaseAbilityCard {...baseAbilityProps} />
            </div>

            {/* Ability Selection */}
            {levels.map((level) => (
              <div key={level}>
                <LevelSectionHeader {...headerProps} />
                <div className="space-y-2">
                  {abilities.map((ability) => (
                    <AbilitySelectionCard key={ability.id} {...selectionProps} />
                  ))}
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );
}
```

## Conven√ß√µes de C√≥digo

### Cores por Tema

- **Detetive (C√£o)**: `themeColor="amber"`
- **Soldado (Espada)**: `themeColor="red"`

### Extra√ß√£o de Cores de Strings

Quando trabalhar com `PATH_COLORS` ou `ABILITY_TYPE_COLORS`:

```tsx
// CORRETO ‚úÖ
const pathColor = PATH_COLORS[ability.path]; // "border-red-700/50 bg-red-950/20"
const [borderColor, bgColor] = pathColor.split(' ');

// INCORRETO ‚ùå
const borderColor = pathColor.split(' ')[1]; // pega o √≠ndice errado
```

### LocalStorage

- Sempre usar `isLoaded` state para prevenir hydration mismatch
- Salvar no useEffect com depend√™ncia `[state, isLoaded]`
- Exibir "Carregando..." enquanto `!isLoaded`

### Tabs

Padr√£o de 2-3 abas:
- **Combate**: Estat√≠sticas e habilidades ativas
- **Habilidades/Despertares**: Sele√ß√£o de habilidades por n√≠vel
- **Pontos de Vida** (opcional): Hist√≥rico de HP

## Regras Importantes

1. **SEMPRE** use componentes reutiliz√°veis quando aplic√°vel
2. **N√ÉO** crie JSX inline que replique a funcionalidade de um componente existente
3. **SEMPRE** extraia cores de constantes tipadas (`PATH_COLORS`, `ABILITY_TYPE_COLORS`)
4. **SEMPRE** use `themeColor` prop para manter consist√™ncia visual
5. **SEMPRE** implemente LocalStorage com `isLoaded` guard
6. **SEMPRE** sincronize level prop com state interno
7. **N√ÉO** use emojis a menos que explicitamente solicitado
8. **SEMPRE** prefira editar arquivos existentes ao inv√©s de criar novos
9. **SEMPRE** pense mobile-first ao criar novos componentes
   - Use tamanhos menores como padr√£o e escale com `sm:`, `md:`, `lg:`
   - Teste responsividade em telas pequenas (320px+)
   - Use `overflow-x-auto` quando necess√°rio para scroll horizontal
   - Adicione `min-w-0` para prevenir overflow de texto
   - Use `flex-col` para mobile e `sm:flex-row` para desktop

## Pr√≥ximas P√°ginas/Personagens

Ao criar novos personagens ou itens:

1. Criar tipos em `types/[nome].ts`
2. Criar p√°gina em `app/[tipo]/[nome]/page.tsx`
3. Seguir a estrutura padr√£o de p√°gina acima
4. Reutilizar TODOS os componentes aplic√°veis
5. Manter consist√™ncia com cores tem√°ticas
6. Adicionar rota no componente de navega√ß√£o principal

## Exemplos de Refer√™ncia

- **Detetive (C√£o)**: `app/detetive/cao/page.tsx`
- **Soldado (Espada)**: `app/soldado/espada/page.tsx`
